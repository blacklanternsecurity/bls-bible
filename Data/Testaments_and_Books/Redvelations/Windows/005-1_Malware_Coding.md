<!---------------------------------------------------------------------------------
Copyright: (c) BLS OPS LLC.
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, version 3.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.
You should have received a copy of the GNU General Public License
along with this program. If not, see <https://www.gnu.org/licenses/>.
--------------------------------------------------------------------------------->
# Offensive Windows Shellcode
### References

### Process

1. Establish Reverse Shell
	* DO THIS BEFOREhand. Interactive shell is useful.
	* C2 generates shellcode properly
1. Identify Worthwhile Exploit
	* AD CVE
1. Find a PoC
	* C, C++
		* Native binary, unmanaged
	* .NET
		* Managed Code (runs through CLR)
1. <details><summary>Make position-independent (Click to expand)</summary><p>
	* C, C++
		* Can be directly converted to shellcode with tools (just move to next step `:)` )
	* .NET
		* Visual Studio
			* Costura.Fody Nuget Package
				* Notes
					* Not yet used in real engagement (2022.01)
				* Install
					
						Install-Package Costura.Fody
				* Usage
					* Should automatically apply with build
1. <details><summary>Convert to shellcode (Click to expand)</summary><p>
	* Notes
		* Completed shellcode should be able to function without relying on other libraries.
	* .NET
		* donut
			* Notes
				* Evasiveness Unknown (e.g., Crowdstrike)
	* C/C++
		* "PE To Shellcode" -<br />[https://github.com/hasherezade/pe_to_shellcode](https://github.com/hasherezade/pe_to_shellcode)
1. <details><summary>Submit to a loader (Click to expand)</summary><p>
	* Notes
		* Transplants an exploit into memory
		* Output should be execution ready.
	* recommended: nimcognito ([nimcognito Tool Guide](Testaments_and_Books/Redvelations/Tools/Malware/nimcognito.md))

			.
		* Add to guide: Relies on LOLBIN
	* Transacted Hollowing
		* Needs Testing: Ares
			* [https://github.com/Cerbersec/Ares](https://github.com/Cerbersec/Ares)
	* Reflective Loaders
		* NEEDS TESTING.
			* May need packaging with a LOLBIN
			* [https://github.com/SecIdiot/TitanLdr](https://github.com/SecIdiot/TitanLdr)
			* KaynLdr -<br />[https://github.com/Cracked5pider/KaynLdr](https://github.com/Cracked5pider/KaynLdr)
				* Notes
					* Based on TitanLdr
					* Output to EXE
				* Command
					
						kaynldr: kayninject.x64.exe <injection target PID> <DLL to inject>
1. <details><summary>Proceed with Payload (Click to expand)</summary><p>
	* Test against local AV guide