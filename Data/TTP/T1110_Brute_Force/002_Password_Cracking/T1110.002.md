<!---------------------------------------------------------------------------------
Copyright: (c) BLS OPS LLC.
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, version 3.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.
You should have received a copy of the GNU General Public License
along with this program. If not, see <https://www.gnu.org/licenses/>.
--------------------------------------------------------------------------------->
# T1110.002 - Password Cracking - Hashcat

## Tags

<details>
	<summary>TEXT (click to expand)</summary>
	<p>
</details>

## References
<details>
	<summary>References (click to expand)</summary>
	<p>
	* MITRE ATT&CK -<br />[https://attack.mitre.org/techniques/T1110/002](https://attack.mitre.org/techniques/T1110/002)
	* Hashcat GitHub Reposityory -<br />[https://github.com/hashcat/hashcat](https://github.com/hashcat/hashcat)
	* Hashcat Wiki -<br />[https://hashcat.net/wiki/#howtos_videos_papers_articles_etc_in_the_wild](https://hashcat.net/wiki/#howtos_videos_papers_articles_etc_in_the_wild)
		* Hashcat Wiki: Example Hashes -<br />[https://hashcat.net/wiki/doku.php?id=example_hashes](https://hashcat.net/wiki/doku.php?id=example_hashes)
		* Hashcat Wiki: Example Hashes -<br />[]()
		* Hashcat Wiki: Example Hashes -<br />[]()
		* Hashcat Wiki: Example Hashes -<br />[]()
		* Hashcat Wiki: Example Hashes -<br />[]()
		* Hashcat Wiki: Example Hashes -<br />[]()
	* Hashcat FAQ -<br />[https://hashcat.net/faq/](https://hashcat.net/faq/)
</details>

<details>
	<summary>TEXT (click to expand)</summary>
	<p>
</details>

## Overview 

* Options for cracking
	* BLS Crackhouse - GUI
	* BLS Crackhouse - SSH
	* Locally (not recommended)
* Generate a wordlist in addition to these attacks using this tool:
	* passwordstretcher
		* GitHub -<br />[https://github.com/TheTechromancer/password-stretcher](https://github.com/TheTechromancer/password-stretcher)
		* `pip install password-stretcher`

## Techniques
### Usage

```
hashcat [options]... hash|hashfile|hccapxfile [dictionary|mask|directory]...
```

### Basic Examples

```
- [ Basic Examples ] -

  Attack-          | Hash- |
  Mode             | Type  | Example command
 ==================+=======+==================================================================
  Wordlist         | $P$   | hashcat -a 0 -m 400 example400.hash example.dict
  Wordlist + Rules | MD5   | hashcat -a 0 -m 0 example0.hash example.dict -r rules/best64.rule
  Brute-Force      | MD5   | hashcat -a 3 -m 0 example0.hash ?a?a?a?a?a?a
  Combinator       | MD5   | hashcat -a 1 -m 0 example0.hash example.dict example.dict
  Association      | $1$   | hashcat -a 9 -m 500 example500.hash 1word.dict -r rules/best64.rule

```

### Attack Modes

- [ Attack Modes ] -

  # | Mode
 ===+======
  0 | Straight
  1 | Combination
  3 | Brute-force
  6 | Hybrid Wordlist + Mask
  7 | Hybrid Mask + Wordlist
  9 | Association

* Dictionary Attack ("Straight Mode")
	* Wordlist attack
* Mask and Bruteforce Attack
	* Masks are highly recommended
	* See below section **Masking** for more information
* Combined attacks
	* Combinator
		* ` -m 0 -a 1 hash.txt dict1.txt dict2.txt`
		* `-j,  --rule-left=RULE              Single rule applied to each word on the left dictionary`
		* `-k,  --rule-right=RULE             Single rule applied to each word on the right dictionary`
		* Example:
			<details>
			<summary>TEXT (click to expand)</summary>
			<p>
			* `dict1.txt`
				* One
				* Two
			* `dict2.txt`
				* Four
				* Five
			* `-j '$-'`
			* `-k $!`
			* Output:
				* `One-Four!`
				* `One-Five!`
				* `Two-Four!`
				* `Two-Five!`
			</details>
	* Hybrid Attack
		* `-a 6 example.dict ?d?d?d?d`
		* Alternative to 

### Hash Formats

* Common formats:
	* NTLM hashes
		* DCSYNC
	* NTLMv2
		* Responder
```
Hash-Mode 	Hash-Name 	Example 

1000 	NTLM 	b4b9b02e6f09a9bd760f388b67351e2b 

5500 	NetNTLMv1 / NetNTLMv1+ESS 	u4-netntlm::kNS:338d08f8e26de93300000000000000000000000000000000:9526fb8c23a90751cdd619b6cea564742e1e4bf33006ba41:cb8086049ec4736c

5600 	NetNTLMv2 	admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030 
```

### Masking
#### Overview
* The mask length determines the password lengths to attempt
* - `--increment` - Increments mask attempts. **Note:** This only goes up to the length of the specified mask

#### Common masks

* ?u?l?l?l?l?l?d?d?d?d
* ?u?l?l?l?l?l?d?d?d?d?s
* ?u?l?l?l?l?l?d?d
* ?u?l?l?l?l?l?d?d?d?s
* ?l?s?l?l?l?d?l?l

#### Built-in Charsets

```
?l = abcdefghijklmnopqrstuvwxyz
?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ
?d = 0123456789
?h = 0123456789abcdef
?H = 0123456789ABCDEF
?s = «space»!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~
?a = ?l?u?d?s
?b = 0x00 - 0xff
```
#### Custom Charsets

* #@TODO - Needs more detail here.

```
--custom-charset1=CS, -1=CS
--custom-charset2=CS, -2=CS
--custom-charset3=CS, -3=CS
--custom-charset4=CS, -4=CS
```

### Options
#### Common Options

 Options Short / Long           | Type | Description                                          | Example
================================+======+======================================================+=======================
 -m, --hash-type                | Num  | Hash-type, references below (otherwise autodetect)   | -m 1000
 -a, --attack-mode              | Num  | Attack-mode, see references below                    | -a 3

#### Full Options List

<details>
	<summary>Full Options List (click to expand)</summary>
	<p>
	 Options Short / Long           | Type | Description                                          | Example

	================================+======+======================================================+=======================

	 -m, --hash-type                | Num  | Hash-type, references below (otherwise autodetect)   | -m 1000

	 -a, --attack-mode              | Num  | Attack-mode, see references below                    | -a 3

	 -V, --version                  |      | Print version                                        |

	 -h, --help                     |      | Print help                                           |

	     --quiet                    |      | Suppress output                                      |

	     --hex-charset              |      | Assume charset is given in hex                       |

	     --hex-salt                 |      | Assume salt is given in hex                          |

	     --hex-wordlist             |      | Assume words in wordlist are given in hex            |

	     --force                    |      | Ignore warnings                                      |

	     --status                   |      | Enable automatic update of the status screen         |

	     --status-json              |      | Enable JSON format for status output                 |

	     --status-timer             | Num  | Sets seconds between status screen updates to X      | --status-timer=1

	     --stdin-timeout-abort      | Num  | Abort if there is no input from stdin for X seconds  | --stdin-timeout-abort=300

	     --machine-readable         |      | Display the status view in a machine-readable format |

	     --keep-guessing            |      | Keep guessing the hash after it has been cracked     |

	     --self-test-disable        |      | Disable self-test functionality on startup           |

	     --loopback                 |      | Add new plains to induct directory                   |

	     --markov-hcstat2           | File | Specify hcstat2 file to use                          | --markov-hcstat2=my.hcstat2

	     --markov-disable           |      | Disables markov-chains, emulates classic brute-force |

	     --markov-classic           |      | Enables classic markov-chains, no per-position       |

	 -t, --markov-threshold         | Num  | Threshold X when to stop accepting new markov-chains | -t 50

	     --runtime                  | Num  | Abort session after X seconds of runtime             | --runtime=10

	     --session                  | Str  | Define specific session name                         | --session=mysession

	     --restore                  |      | Restore session from --session                       |

	     --restore-disable          |      | Do not write restore file                            |
	     
	     --restore-file-path        | File | Specific path to restore file                        | --restore-file-path=x.restore

	 -o, --outfile                  | File | Define outfile for recovered hash                    | -o outfile.txt

	     --outfile-format           | Str  | Outfile format to use, separated with commas         | --outfile-format=1,3

	     --outfile-autohex-disable  |      | Disable the use of $HEX[] in output plains           |

	     --outfile-check-timer      | Num  | Sets seconds between outfile checks to X             | --outfile-check=30

	     --wordlist-autohex-disable |      | Disable the conversion of $HEX[] from the wordlist   |

	 -p, --separator                | Char | Separator char for hashlists and outfile             | -p :

	     --stdout                   |      | Do not crack a hash, instead print candidates only   |

	     --show                     |      | Compare hashlist with potfile; show cracked hashes   |

	     --left                     |      | Compare hashlist with potfile; show uncracked hashes |

	     --username                 |      | Enable ignoring of usernames in hashfile             |

	     --remove                   |      | Enable removal of hashes once they are cracked       |

	     --remove-timer             | Num  | Update input hash file each X seconds                | --remove-timer=30

	     --potfile-disable          |      | Do not write potfile                                 |

	     --potfile-path             | File | Specific path to potfile                             | --potfile-path=my.pot

	     --encoding-from            | Code | Force internal wordlist encoding from X              | --encoding-from=iso-8859-15

	     --encoding-to              | Code | Force internal wordlist encoding to X                | --encoding-to=utf-32le

	     --debug-mode               | Num  | Defines the debug mode (hybrid only by using rules)  | --debug-mode=4

	     --debug-file               | File | Output file for debugging rules                      | --debug-file=good.log

	     --induction-dir            | Dir  | Specify the induction directory to use for loopback  | --induction=inducts

	     --outfile-check-dir        | Dir  | Specify the outfile directory to monitor for plains  | --outfile-check-dir=x

	     --logfile-disable          |      | Disable the logfile                                  |

	     --hccapx-message-pair      | Num  | Load only message pairs from hccapx matching X       | --hccapx-message-pair=2
	     
	     --nonce-error-corrections  | Num  | The BF size range to replace AP's nonce last bytes   | --nonce-error-corrections=16

	     --keyboard-layout-mapping  | File | Keyboard layout mapping table for special hash-modes | --keyb=german.hckmap

	     --truecrypt-keyfiles       | File | Keyfiles to use, separated with commas               | --truecrypt-keyf=x.png

	     --veracrypt-keyfiles       | File | Keyfiles to use, separated with commas               | --veracrypt-keyf=x.txt

	     --veracrypt-pim-start      | Num  | VeraCrypt personal iterations multiplier start       | --veracrypt-pim-start=450

	     --veracrypt-pim-stop       | Num  | VeraCrypt personal iterations multiplier stop        | --veracrypt-pim-stop=500

	 -b, --benchmark                |      | Run benchmark of selected hash-modes                 |

	     --benchmark-all            |      | Run benchmark of all hash-modes (requires -b)        |

	     --speed-only               |      | Return expected speed of the attack, then quit       |

	     --progress-only            |      | Return ideal progress step size and time to process  |

	 -c, --segment-size             | Num  | Sets size in MB to cache from the wordfile to X      | -c 32

	     --bitmap-min               | Num  | Sets minimum bits allowed for bitmaps to X           | --bitmap-min=24

	     --bitmap-max               | Num  | Sets maximum bits allowed for bitmaps to X           | --bitmap-max=24

	     --cpu-affinity             | Str  | Locks to CPU devices, separated with commas          | --cpu-affinity=1,2,3

	     --hook-threads             | Num  | Sets number of threads for a hook (per compute unit) | --hook-threads=8

	     --hash-info                |      | Show information for each hash-mode                  |

	     --example-hashes           |      | Alias of --hash-info                                 |

	     --backend-ignore-cuda      |      | Do not try to open CUDA interface on startup         |

	     --backend-ignore-opencl    |      | Do not try to open OpenCL interface on startup       |

	 -I, --backend-info             |      | Show info about detected backend API devices         | -I

	 -d, --backend-devices          | Str  | Backend devices to use, separated with commas        | -d 1

	 -D, --opencl-device-types      | Str  | OpenCL device-types to use, separated with commas    | -D 1

	 -O, --optimized-kernel-enable  |      | Enable optimized kernels (limits password length)    |

	 -w, --workload-profile         | Num  | Enable a specific workload profile, see pool below   | -w 3

	 -n, --kernel-accel             | Num  | Manual workload tuning, set outerloop step size to X | -n 64

	 -u, --kernel-loops             | Num  | Manual workload tuning, set innerloop step size to X | -u 256

	 -T, --kernel-threads           | Num  | Manual workload tuning, set thread count to X        | -T 64

	     --backend-vector-width     | Num  | Manually override backend vector-width to X          | --backend-vector=4

	     --spin-damp                | Num  | Use CPU for device synchronization, in percent       | --spin-damp=10

	     --hwmon-disable            |      | Disable temperature and fanspeed reads and triggers  |

	     --hwmon-temp-abort         | Num  | Abort if temperature reaches X degrees Celsius       | --hwmon-temp-abort=100

	     --scrypt-tmto              | Num  | Manually override TMTO value for scrypt to X         | --scrypt-tmto=3

	 -s, --skip                     | Num  | Skip X words from the start                          | -s 1000000

	 -l, --limit                    | Num  | Limit X words from the start + skipped words         | -l 1000000

	     --keyspace                 |      | Show keyspace base:mod values and quit               |

	 -j, --rule-left                | Rule | Single rule applied to each word from left wordlist  | -j 'c'

	 -k, --rule-right               | Rule | Single rule applied to each word from right wordlist | -k '^-'

	 -r, --rules-file               | File | Multiple rules applied to each word from wordlists   | -r rules/best64.rule

	 -g, --generate-rules           | Num  | Generate X random rules                              | -g 10000

	     --generate-rules-func-min  | Num  | Force min X functions per rule                       |

	     --generate-rules-func-max  | Num  | Force max X functions per rule                       |

	     --generate-rules-seed      | Num  | Force RNG seed set to X                              |

	 -1, --custom-charset1          | CS   | User-defined charset ?1                              | -1 ?l?d?u

	 -2, --custom-charset2          | CS   | User-defined charset ?2                              | -2 ?l?d?s

	 -3, --custom-charset3          | CS   | User-defined charset ?3                              |

	 -4, --custom-charset4          | CS   | User-defined charset ?4                              |

	     --identify                 |      | Shows all supported algorithms for input hashes      | --identify my.hash

	 -i, --increment                |      | Enable mask increment mode                           |

	     --increment-min            | Num  | Start mask incrementing at X                         | --increment-min=4

	     --increment-max            | Num  | Stop mask incrementing at X                          | --increment-max=8

	 -S, --slow-candidates          |      | Enable slower (but advanced) candidate generators    |

	     --brain-server             |      | Enable brain server                                  |

	     --brain-server-timer       | Num  | Update the brain server dump each X seconds (min:60) | --brain-server-timer=300

	 -z, --brain-client             |      | Enable brain client, activates -S                    |

	     --brain-client-features    | Num  | Define brain client features, see below              | --brain-client-features=3

	     --brain-host               | Str  | Brain server host (IP or domain)                     | --brain-host=127.0.0.1

	     --brain-port               | Port | Brain server port                                    | --brain-port=13743
	     
	     --brain-password           | Str  | Brain server authentication password                 | --brain-password=bZfhCvGUSjRq

	     --brain-session            | Hex  | Overrides automatically calculated brain session     | --brain-session=0x2ae611db
	     
	     --brain-session-whitelist  | Hex  | Allow given sessions only, separated with commas     | --brain-session-whitelist=0x2ae611db
</details>

